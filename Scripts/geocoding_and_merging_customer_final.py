# -*- coding: utf-8 -*-
"""Geocoding_and_merging_customer_final.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1UH4I-WLPZ2R_LFhHdb-gmZxJZGHKS-yD

#Forward Geocoding and merging with the Customer data including 'Region' and 'Priority' columns.
--------------------------------------------------------------------------------
**Date:** 23rd March 2025

**Author:** N Priyanka
--------------------------------------------------------------------------------
**Dataset used:** [Omdena_Repzone_v1.xlsx](https://docs.google.com/spreadsheets/d/1wvKHQJZ2K4SG9grAL5_nfXOw5kR2v180/edit?usp=drive_link&ouid=115723219790786707059&rtpof=true&sd=true)

**Description:**

This notebook is divided into the following main sections:

1. Geocoding the 64 missing addresses using ArcGIS API by geopandas library.

Here we have successfully geocoded 63 out of 64 customer addresses.
The below address is not geocoded:
* Tosmur Mah. 8. Sok. No:1 A/A,A/B,A/C,A/D Alanya/Antalya ,Alanya,Antalya,Turkey

2. Dropping this customer location from the Customer data, we have 2653 customers.

3. Obtaining the regions for each of the customers using OpenStreetMap API.

4. Assigning random priority to the customers (1 = High Priority, 10 = Low Priority).

5. Dataset cleaning: Removing duplicates and inconsistent capitalization issues with the 'City' and 'District' columns.

**Artifacts**
1. **geocoded addreses:** [geocoded_arcgis.csv](https://drive.google.com/file/d/1xCP-an5fcOvPdpUfrDwouAUk0v7eLIPF/view?usp=drive_link)
2. **Folium map with these geocoded locations:** map.html
3. **Final Customer data:** [customers_with_region_and_priority_V2.csv](https://drive.google.com/file/d/1k_E_Yc1POe-vzN_rsOqrnEcOXfFHk4ex/view?usp=drive_link)

-------------------------------------------------------------------------------
![image.png](data:image/png;base64,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9kqHrESJwgkTMAETMAETMAETMIEfQcAx0R8xzO6kCZiACZiACZiACTwhASvRJxwUu2QCJmACJmACJmACP4KAleiPGGZ30gRMwARMwARMwASekICV6BMOil0yARMwARMwARMwgR9BwEr0RwyzO2kCJmACJmACJmACT0jASvQJB8UumYAJmIAJmIAJmMCPIGAl+iOG2Z00ARMwARMwARMwgSckYCX6hINil0zABEzABEzABEzgRxCwEv0Rw+xOmoAJmIAJmIAJmMATErASfcJBsUsmYAImYAImYAIm8CMIzFWiwzBsNpvq+2+73R6PR+Dp+x6ZVVXpHqbY1RSnuq67jmXWyOl0quuajfZ9D+MlD1cxcp3/rmUCJmACJmACP5PARYvvRVriUhmQNb6KkXEcs90sCZKsJyUjl06brCc37ealHpbKz1WipfrONwETMAETMAETMAETMIHrCFiJXsfNtUzABEzABEzABEzABJYSsBJdStD1TcAETMAETMAETMAEriNgJXodN9cyARMwARMwARMwARNYSsBKdClB1zcBEzABEzABEzABE7iOgJXoddxcywRMwARMwARMwARMYCkBK9GlBF3fBEzABEzABEzABEzgOgJWotdxcy0TMAETMAETMAETMIGlBKxElxJ0fRMwARMwARMwARMwgesIWIlex821TMAETMAETMAETMAElhKwEl1K8Ir62H2L+5ReYcFVTMAETMAETMAEnpNA13XYk7xtW/WQG3JevQu6WkvTaPfl1MVSJXo8Hrfb7cL95VOayNH9UsNwlqqk+cMw7Ha74/GYnrpFjvpcwmIlegvytmkCJmACJvA8BKi66ro+nU7qGE9xZWdOVVWbzWYYhnEcdff21IgafM5013XsoHrYtu0zKNGSG8TOgaDzGKbVle4iJQpFBaBwfUX/oHE5iv33H3HMT9xZicIxJZO6aiWaMnGOCZiACZjA2xDo+x7LN9Y7LuXhkP1t23ZaP7Tffyz/Eon7K9GLsGSVaN/3qQCF2b7vd99/0yN1kQ8ovEiJ9n2/3W4Zblx3onRdl70G0qFVlYn5jTAkvNJ4LfKVL6/AmNn3fdM0dV1vNpvD4bDZbOiAmuKlTN/3dV1/fX1tNpuqqvhLG8cRzrAkWKuRqqpWH8srht9VTMAETMAETOCmBHQ1p0INLZ5Vorr0h7o4PJ1OTdNAllRV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GNcljNKHd+ezSlSBstsYkl+/funlAs86YQImYAImYAImsC6BrAyF1mGgMRvm1Fv26lJ2fdcCJSWqjwfAK4iBtZQouoPW+f0pOKZNqKsqxzV/SbrruixY9SHLUDNLAelSPt7KmggazuzRUiVamjQzm58upkFyivrwuhbRM/KfvsOlIzTdos+agAmYgAmYgAksJBBW6qqqGAziKS7fEDpYu5kJ2crbxGflTkmJIuSJd971IVSVaNnYlhII0USVknzC9XA47Ha7YRjgCT3nC/vaTZxlrE3bujpNsCqImamv/GsTqkTDu/M6auq8jpF2ljpN7c9JL1Wic9p4eBmdcA93xg6YgAmYgAmYgAmYwDMQeAaB9P5K9EaPsT7DBLIPJmACJmACJmACJnAdgYnb7tcZvK7WOytR3tznTYHrGLmWCZiACZiACZiACbwHAaojPjnw2H69sxJ9LFm3bgImYAImYAImYAImME3ASnSaj8+agAmYgAmYgAmYgAncioCV6K3I2q4JmIAJmIAJmIAJmMA0ASvRaT4+awImYAImYAImYAImcCsCr6pE27bVL2atiAevkp39dNmKLdqUCZiACZiACZjA2xDgVzzDJzb58dF1vyQ6wW36I034GujDBc9SJapvYK3YGf1WalVV+hlVEJ+vRM9+sTYM4UVKdGILrGDWhyZgAiZgAibwcwhQdaXagKco1JhTVRXDTDcSGHcbgpIK1A/j39qZkg9od7kSXaUvi5So7jqA/qwl84O1tm1TMTpz/C5VojPNopiV6EW4XNgETMAETOAnEOj7HioTqzkVZzgkirZtp7+3eKN9xenALRIlFbiKepvpcMmHmdXPFlulL4uUaBB5qziEbgclqoe8SAraFGV0uzDdnAr5vNKCgvz6+sIOYPyRlCLq2FyVm3f1fU83mBn8OTt+LmACJmACJmACb09A95OkQg29PqtEzyqq0+nUNA32sg+3UnW91uUeNrGIT+vg4/FY1zW2N9dtMzUapbE59K7k84piSTFSwOgunfCBIWd0U/WSdifs9qmxRa0CtaPNgSHZqldz0ouUKDxD4H3dDehhWSmE66EggqEUsxTSktzNFjTTTZjS2VPauV5n4RzcLmMCJmACJmACP4qAKtG2bff7/Xa7DfpvWolCEkyLRZRBvEklBGJSqIs0pAWEFNPpIwQ6RqgIzaAGVQM8VolCgh+PRygcxt20m1qGvdPRKXFDflZiraKqFylR9AT9XDciqDjYilJI9WVJLKYlwzihLZ3iQYnqtOPgIaGzMJzyoQmYgAmYgAn8cAKIR2oojmpBA1gM2lVVpUGovu+hWaeV4jiOYSnnOq5KC6s/TLHAOI5ZnaADF1Qm5ZdqgFBmIkDG6trEknQqmdiEdjMrZpTPMAxN05xOJzjDulkJizJsaIn/i5QoOg+BCD2qem6JW1ms00p0HEdOZZ3H2Rmmsyf1k/RxKg2assq0HRZzwgRMwARMwAR+GgFIH67IQSyGQ8AJVUhsQgyhTLDGdZwJFOOqrfmqE/RWPkVzUJmUX7SG+9q73W4YBvqsTTATWoVMNP/qdOi7NqE+pMUgl6nyqfuh/rkXqKrV4CRRhPyLDhcp0TAzJny9yCde3HCo0qmp8yYYD4WzJXX2hOrpdUyYglp+2o6WdNoETMAETMAEfg4BrMUaQlKFxIU+DWBlxc3EQgykQWZRgQVlwkMWeL+YKFBAQWk3swwJRAPGYZZOSJ3sYIXqZw+XKlE+i4Cehzl3tvlSAeWINDU7qmT1JU5pXT5+G+b6BNZUieLHExygGx8fH3oNVOqR803ABEzABEzghxDIylBoHQYaQzALZPSWvbJSwaT5TGPp51pPBaaPB8ArlGGBhUoU3UHrVETwSpugn0GOa/6StD6gqGDVhyxDzQyBPPpTyg8hVZa/NLFIicKJEMW91INseQxq1jIeA+ApnQTMDIKYAWfOkqwSDY0yLg0Peetf30pTAvx1ZXvkTBMwARMwARP4IQTCSq3rJk9x0YTQwQrOTMhWLuvZYJDCLClRCE18J0cfQlWJNhHbQhMhmqiBQGqDw+GAu/MlLaHdRL9441c7cnWaYCl1VKKEd+TZiipRBu+Incpendcx0s4G6cUmziaWKtGzDbiACZiACZiACZiACZjAExJQRf4o96xEH0Xe7ZqACZiACZiACZjAwwhM3Ha/p09Wovek7bZMwARMwARMwARM4JEE9PsAV99SX7EDVqIrwrQpEzABEzABEzABEzCBCwhYiV4Ay0VNwARMwARMwARMwARWJGAluiJMmzIBEzABEzABEzABE7iAgJXoBbBc1ARMwARMwARMwARMYEUCVqIrwrQpEzABEzABEzABEzCBCwi8thLNfqD+RhsYXADVRU3ABEzABEzABH4qAX5kPryZzs/gr/tN+wnM058LxXfpz+4aMGF/lVNLlah+C4Df4l/FMxjBsJUsP1CJ6n4D6W4EFxE4u7vDRdZc2ARMwARMwAQeToCqKxU6PEWhxpyqqrhFkAqM1MjDO3jWgZIK1C2azhpZWKDkA8wuV6Kr9GWREoUag0wchmH1HdiPx2Nd14fDgZM1DMkDlSg9CTtlMX9+wkp0PiuXNAETMAETeH4Cfd9j4YbW4SIeDtmRtm1LISeUab//WP4lEiUVuIp6m0mg5MPM6meLrdKXRUo0iLBVHNJuQ2j+97//rev6eDzyFOPeuo8q5jfDkwh9Q+T9+fNnu91qYd2MtbSDquZrBDRcmQUI4ziqJ/z59X3PjXdRoK7rf/75B47RbV4LsrNOmIAJmIAJmMDrEtBVkgo1dOesEj2rqE6nU9M0fd9jVdUVXGOrXJS77z/GYqd1MOJifd9j/3rKAA2Hhb3pITPYnPZ3dbEE4yqN2B1wC91UlRKkkaodfYRAq4CtNgcNk+2sdryUXqpEteGzE6XkRCkfo4X+EyvmGYSpTgK9YOIwY/5B3mkEV43oj6TUBRpMXdXqOEtP4DnHsus6jh/n8TiOjommVJ1jAiZgAibwHgR0lWzbdr/fMwTDlX1aiQYZkMWCMljudfHVpR9pLMoQUkzropzaR0Ws4GpQRchjlaiqGijmYRgYdEM3tQz7qKNT4oZ81XusPqGOWOZsYpES1Tvy0HxZR886kS2gg0qBCBycu5wEQcwRDbxieebrpA8N6YUUHWvbtjRNdRTHccSVEyO49BCm8CPc7XaYIsgMzrNRJ0zABEzABEzgpQnoKowVnIusCiYG7aqqYvhmHEfcTgxxuyyQIA8oG8IazUWZBebEg1Qn6FvRtIbVPyzu2oT6TCmimUvS6LtyYxPqg2poNqd8hmFomuZ0OuEs62YlLMqwIRq8IrFIiVJuY5Z8fn4qiCu80So6wNRqYaqxDAvAAtGEfJyFEd4Q1+ejMcNwSvuiVahrYU1HERMa0XvaVwmrF2TsbNZJnnXCBEzABEzABF6RQFjywgoeDtHBUIW9nhBDKBOsUUUxgWKUDZqvqzCkM1ZwiuaXUKIqTqiCtJsBEYCohqHup4BBeFHLcESQYEMh/6LDpUpUG9NAo+Zfl9YrJEDp+z5w5JTSaaTXKyEfngQjWfdKPwa9vEPFMELZFrXdw+Gw3W51xkxUyfrmTBMwARMwARN4cgJYRsOdUhUupbVYy7CPQQsyn4lgjQosrNE8ZIH3i4kCBaJp2s0sQwJBBFpjZ2RLrcUcJrKDxbMzE6spUT4cObPh6WJhSkFcYkKzIYhCUMOMh7zThz9KIo+PbJbc0IHUMtoQ8nUU+bpS+O2FkuHaLrWpLTptAiZgAiZgAq9FICtDoXUYaAxLITqot+y1y2Gp1VNIB9lABabxI11tWWChEkV30Hp451ibUIdXUW9qEDeos2DVhyxDzQQfvSGMVkr5aDcrXoN704eLlCicQ8AydX264emzqYLklGWjiCzymQZGlTHG8Ce1w3b1tS9wxEwKQWk8/MHHq8MjLNlhCHZ4XcI5igKcNPooDMvQTydMwARMwARM4LUI6ArLu5roAk9xEeSyXlUVM3VlXPKcaHhqjlpFJdqEVIDPIZqoUpL3bw+HA54TDRqgqioEp7SbtxBOBKtCgpklhqpEU8HD+7fqvI6RdjYbg5szbxcp0TkNuIwJmIAJmIAJmIAJmMATElBF/ij3rEQfRd7tmoAJmIAJmIAJmMDDCCDSyTjxo/ywEn0UebdrAiZgAiZgAiZgAvcmoN8HuPqW+opOW4muCNOmTMAETMAETMAETMAELiBgJXoBLBc1ARMwARMwARMwARNYkYCV6IowbcoETMAETMAETMAETOACAlaiF8ByURMwARMwARMwARMwgRUJ/Agliu9p8bNYS/Dh01mrmFrihuuagAmYgAmYgAk8JwF+xTO8D8SPj97odfX06558OUk/Avps0FZQouhnwM3vzOsXVi/q/BWaTz82q21llejE7lVaN6Sv8CpY8KEJmIAJmIAJvD0Bqq50Dx6eonJgTlVVlA1UUaWvsj85w9KnOktaZXl3wmfqafDsp/tZspQoWdAv3ocgHXQgh7hkeRzHpUoU3W6aRhsbhuHj42MYhrAD1YQf6akrNN9Fo2slmjJ3jgmYgAmYgAksJ9D3PVQBlnIqhHDIhtq2DTqGp5DgRt8h/5kP769ESyqopCPn08tawKVCduCwK1UQh6XmFinRYRj2+71uCo9mdMZAL2cdLfmE/Aklyrg3r5yYE/bqpFpnybDxF8ojah1a1DlEO2d3LZvulM+agAmYgAmYwI8ioIE6KtRA4KwS1RU51MXh6XRqmgYbg4ddQzW2Sk3cff8xFjutUo7HY13Xfd9vNhsN0GpIK+wIikgcm1OfS3pRy1yRhobJ3vdPdaSqGg1aaz6c1xxIIAqqiVGDDjw7aujmIiVKUio9Vc8hne7VzooTCbWjxYZhOBwOyNH5DUGcHYN0fmBDW6U/jmNokQSRD8taBjP+eDxmd59Xn502ARMwARMwgZ9JQFfqtm33+/12uw1hnQlNk67OWYxYnSGSdNWGkILQRBqrOQJYTAc9EJpARQSt1OCTKFG4BKRBLKIjQYkqH6SpmH///g1Vo91ECG+32+EUbEJZfX5+okV9DpXqiDoq8AyHN1SiuNTovv/YydD8xCHoTF+mBLil64yFSlSnmnqlv5xsExO98ykTMAETMAETeHsCegMXCyglC0KMeJCPsckQuuI7J9NKMVWr1ECqgzUIxQJZmRXGJSzxFBsqD0KZZ46JUimim0FKse/sZhYRRpbqrm1bjJHKJIVMs2niVkpUJ5N2JvWglKOd0TLIp/bnnL5dTFSnGr0KbuhD1uqt0yZgAiZgAibwMwkgrsZ7lVxAQSMcIjNUIbcgnpjPRLBGDcQESnJB13yVYnornwIjqEyqGlobxzGUeXIlqspeu0/pD5XFsdMyIBlyeKhgNc2RShPrK9Hw2GiYHKkHpZxSReruVKRzcgSb6fzQCyMWDi2SoE41lmGC1Z0wARMwARMwARMAAWhKxsyQqct0aRnVMoSZXcd5dn5MlCFSLvGpllCzSIfW6aHKg1DmyZUoRTbkEA41gB2iexSahBP6iwL//PNPXdeMFSLB50pZNyRuokShqXFj/ex1THCIhxNzFDMbBZQmZxiNIBF4IVNf8EcODOIKQL8+oCVxBwFd67pOWw+N+tAETMAETMAEfiaBrAxV0RPSpKS37Jk552WMoBkoNFVdwSuu4FTJqczSptN4pypRyAC0HiQXfQjWWD3kLzxUDRNMhQ5q4FlrqdqBCmJMVNHRuL4jpGkWKBFgASQWKVF4puKX48oA79VaDXTUOGaPRs4/Pz/1EVqtAk/oRlaY8417OknjdV1/fn6yOywJrPAEvw16qLHuQNmHJmACJmACJvBzCHDR5BKZrptceVVLMBNSldXPrrAQANoKV3Cu7PrcoIqkINTSYQrxLJWSfML1cDjsdrthGFSKwH94ot1EPnVe2uIVOWg32AwDQbzqDEEhDgrf6rpumkatUVBRcGtP1QidV8jMTBOLlGhqzjkmYAImYAImYAImYAImMJOAlehMUC5mAiZgAiZgAiZgAiawMgEr0ZWB2pwJmIAJmIAJmIAJmMBMAlaiM0G5mAmYgAmYgAmYgAmYwMoErERXBmpzJmACJmACJmACJmACMwlYic4E5WImYAImYAImYAImYAIrE7ASXRmozZmACZiACZiACZiACcwk8KOVaNu2/CzWTF6lYrrRQqmM803ABEzABEzABN6eAL/iGb6yyY+P6nc6V6SRfuCT31Lll0RXbG4tUysoUfQz4OZX3/mZ2Us9BtCrq89pLqtE9Yu1c4ygjJXofFYuaQImYAIm8PYEqLrSj9LzFJUDc6qqYoSIKqqqqtTI8wMsfdf9Opkxp7+lnSbPfrr/rPGSBf1CfhBs+BI+h3iiiaVKFN1umkYbg4jc7/fb7TZ4NuFKOHUHJRpaxOF1U8RKNAvTmSZgAiZgAj+QQN/3UAVYyqkQwiHJtG07rRaym0my+nMm7q9ESwKmpCPnc8tawKVCduCwK1UQh6XmFinRYRj2+z22h+I8QzS073so5ayLJW80f0KJ8uKJV06n06lpGuxxX1WVRqEZJNdNt3ilNVGyqip0amKbLzXOKzZ4rs1pv5w2ARMwARMwgZ9DQAN1VKih+2eVaEnV0c6EDOCKz2UdQgU2sVhPa5Xj8VjXdd/3m81GA7QahApSAU2oNKKrJb3IAtcloD2y9/1THamxTKqXcRw1nxJou92CEv6l9JoYNVw5nB019HSREiWs7MXKjZSozumu6yAlMQCgo4MxDMPHx8cwDJDLinscx3RsUCwMZJhenEMQvsfjEdvj0jhpqCdk5YQJmIAJmIAJ/BwCumq3bYv7pUH/TWiacRyxmE6LxZIMUCmCNJZ4BJKY5gqeHRdUhN5Qg0+iROFSViyiO0HtqDhBmor59+/fUDXazaxegjT6/PxEuxrXozp6TyUa0HB2MgHo7Lz+AIiG8yyMDfIpNFksq0RDi5yOuHLCQAaFSoNOmIAJmIAJmMBPIKA3cLFuUrIgxMhQEYWUBoPwrKGGIUvQwqKclQG6KLNAVmaFVrIyQK0hmrjb7dAdVNcm1GAqM/Ts1WkQUHo0FdROkEPhLGupn2kZjCwlbNu2UPM6ECUCbAKJF4uJhtnADjOBXrHzYaITGYqlZOfHREOLVKJ6FwC/q+krrTAePjQBEzABEzCB9yCA4BG1UVg3wyG6HKqQQxBPzGciWKMMYAIluVhrvooBXcQpmoP2oESjtZdToqpMtPuU/hAwHDstA5Ihh4cKVtMcqTTxekpU34JiiLQ0BbNTihQIjjmrKNHdbseYqFp22gRMwARMwAR+CAEs0CEARA03cc9dy5BV0ILMZ6IkA/TWKJ7dhAhTkZQVA7Scqkx6+LpKlCIbkV0cQjLxKQh2Mxs2DiMChv/8809d1wxvI8HnShWppl9MiYbHPTnDSlNQOWq3kc5OPtpkeepdTOKqqnCVwOdBMXgalw6/PZpywgRMwARMwATenkBWhqroCWkC0TuZzFQFqZmaLskAVVdhNedKnRUDajyoLkoLRmrRepBcKnbVGqtr5vI0fGAUUw2GDoIDSmotfbUGwVFaU3S0TBUEbUaeLFAiwAJILFKi8EzFL/wI0d2qqiixQ/MTh6CjxmmE785T1KMwC7DzGhPVd+rE1xzwAAAWzUlEQVT1nXfN51Ua2iVW9gjcMTbsPsK0TdOcTqdggbJ1oqc+ZQImYAImYALvRCAssioDeIorOBfTsBxz5V3ynCjieXjnXVdk6oRswC+MRUmJQoFBMBwOBzwnmqoXaAntJqpQ54XmrjtUTUkLpI0Ws8wpdbQ7dV03TaMecjgouLWnakRbz+azABKLlGiw9YSH4cpD9fsTemuXTMAETMAETMAETOBHEXhnJRquD3A5ogL/R420O2sCJmACJmACJmACz0bgnZVoiMlrWP7ZhsH+mIAJmIAJmIAJmMAPJPDmSvQHjqi7bAImYAImYAImYAKvQsBK9FVGyn6agAmYgAmYgAmYwLsRsBJ9txF1f0zABEzABEzABEzgVQhYib7KSNlPEzABEzABEzABE3g3Alai7zai7o8JmIAJmIAJmIAJvAqBH6FE8WVXfvf+VcbGfpqACZiACZiACbwcAX5PPnzXnfvy3O2DkvoB/xQjPnape9CnZe6Qs4ISxT5GJdwP7yG36LQSvcN8chMmYAImYAImEHbrwQaExEJBRuXAnKqquIWP7pL4DFqC/s9MlFRg2HNnprXripV8gLXlSnSVvixVotilvWkazidsJotDdFJPXYfStUzABEzABEzABF6FQN/3WRlQUgVt205Hi15xi8SSClxFvc2cCSUfZlY/W2yVvixSosMw7Pd7XPqU5CakargeOts37gP758+f7XYb9pxl3Js7qI7jGHZ0xUUVM3mNxaZ5BcZTp9OpaZq+79GiGmctJ0zABEzABEzABOYTUBlAhRqqn1WiZxXVxAqusVVqle77j0pgWgcfj8e6rvu+x/71DND2fc902Jse92PZnPZ3FfWmBpGmNKqqit0Bt9BNXA9gJ/qgr6iawmZAWgXqSJuDqWxnUz/TnEVKlOYmLlZ0CrL8nASmjgpKkIVSPB6PGGZOAvqAihwGiNTdbjcMA9tVr7quA1aARotI3+1JDjrmhAmYgAmYgAm8EwFdcNu23e/3CPeoYJpWoliRdVlP+ZRWcEgr1EUaKzuEFNPUEqllhrogFdTg8yhRlUZQzNA82k0tw27q6Kjy0W4iPys0V1HVt1WiqShk588mQl32VucrL0FSZCoiWQyNauFxHDnFmUCxs1dgZ7vgAiZgAiZgAibwkwnoUo5FlvcbVTAxaBdCcX3fI942rRR1KQdtruCqtPD0IEyxAO/BIsKVHaygIihInkSJAqzKHnqo3Qzih6DIdhiGpml4E5t1sxIW1dlQltvMzBsqUfRZ0cz0CcWGYdjtdmFmADdDyny0GfkQ7MMwfHx8aAQ0zKFwiLp93zMBBzgGF7ntwiZgAiZgAiZgAgwlUgaERTYcglhJOUyIIVQM1riCM4Fi1I6ar3oD0hkyg6I5yAbKL1or3X29XRxRJ1joO56ZBHbtZlos3Fum7qfKgv9BzWvTRKGZl6ZvpUQxmbJjMNNFnRmskuWIs6UrqnR+hMsCHgbjOn50wAkTMAETMAETMIGzBLIyQIVLWHNpUMswM2hB5jMRrHEFDyqKhyzwfjFRoEiVaJYhgWjAmFSRUMEdTmUHK5Q5e3gTJZqdf2ddCQWyShT6nZcprFIqjAIp/bZtGY7mMJTmMVtxwgRMwARMwARM4CyBkgzQ0KamaVBv2TMzhO40n+nSCq6PBzDwBIMMlk1LiDSeRfnFLqB1vgANr1Ts0k8NWGrmwjTfeIGgpExSH6h2tC3NBB/GsFmslD9nXGhkIrFIicI5RnGrqmIgVzP1qeQJV8KpiZmhb2xRUGpMlA+ahFCzzhKW54CV5nFwzIcmYAImYAImYAITBHSZhh7g+0Y8xcVXtQQzoaioJbjWlxqdWMH1hjtllkq0Cb2B5kI8i0pUP5t6OBzwbjQ8oeeURtpNnKUzpU5dlE+wKnWYGd6Rp2VVonyggs5z1NR5HSPtLJU9jc9MLFKiM9u4Q7EwjdJHRe/gg5swARMwARMwARMwgRcioIr8UW6/iRJlhBwcNUz9KLJu1wRMwARMwARMwASelgAineuGZq/o7JsoUY2QV1WloeMroLiKCZiACZiACZiACbwlAX1c4epb6iuSeR8luiIUmzIBEzABEzABEzABE7gDASvRO0B2EyZgAiZgAiZgAiZgAhkCVqIZKM4yARMwARMwARMwARO4AwEr0TtAdhMmYAImYAImYAImYAIZAm+lRPEW2NmvjmUwSNYqRsSekyZgAiZgAiZgAj+IAL/iGd4H4ofMb/S6OtrlR0BfhfgKShQvYSlufS3ral3IgeTm8meZriIis0bCJ3PPeuICJmACJmACJvCTCVB1pTKAp6gcmKMr/ipa4oFDUPpUp34Yf133LlKiJTeIXb+QDz8xTKsr3aVKFF/nb5qG8ylgbb//QuacQ/3uf2n7rzl2ViljJboKRhsxARMwARP4CQT6vocqwOpJhRAOiaJt22l9c7WWYBP3T9xfiV7Ux6wSnZBbfd/vvv+mR+oiH1B4kRIdhmG/3+NbnpxnwYnSSIRi6aEqUcxdRLP7vq/r+uvra7PZcBMtbH6K/amCJxpbJb6LjOi1GnfoQuiUBsNh2h3nmIAJmIAJmMAPJKCrORVq4HBWiZ7VEqfTqWkabHMTPivOIF/QDLCJZZ2reXAMh8fjsa5rqDTdNhNa4nQ6pXvTh63t1WxWAmqBK9IQIRpRhpHu+48yBt1UXaTCCQyHYUgdgP2//voLHNICS3IWKVE2XLpYWRJK1LkblCgnWbqrZ5isuveSKn3sR48P4J81Mo5jtiPaa22IWJwwARMwARMwgR9OQFfztm33+/12uw36b1qJZpfgQBVlcENZNYPGiZBGVAtqjOn0EQK1j4rQDGrweZQovD0ej7vdTqXkRDdTQYyN0/f7PUZHmUDwzBkI5TYzfSslCqmnlw4zHWIxnbu6e6cKyhSKKlGdizBL7vONoGLa0DiOutk9LdN/J0zABEzABEzghxNAPBKhOKyk3ARRF2IG7aqq0rd55muJsExTDKiWGMeR2pEFwmqeHa+g8Lji09rDY6JwO/gZ4rIqWnA3W1EDDvmDJ24ys2KAnGV1ReatlChduTpYqNFjTlydRmxCEzq3UmTZ2aPVkVYjyElNaaAUcfvj8Ziaco4JmIAJmIAJ/EwCGoPURRM0sgtrqEJuZ7VEsMZ1nAmYonbUfCotqFI8+8e7r6nKzGqJaRXIjmQloJ5dkp72QbuZdYNwlNW///7LO/IB8hJXte7NlWjKRZufSIfrGJYMpJiPhM4tIKPk18P5RmC2RB/NlR58Cb750ARMwARMwAR+CAFoyvDmBjVcKkyJRcsw86yWCMs0xUDQEjxkAcdECTlIVSilv//+m9Icd+2X3O5mW5q4uRLlqGurc9KliheJyHBbn7HVi4zAW30qlP7jt/Hr1y99LINnnTABEzABEzCBH0ggK0NxV1MXYqaJSG/ZMxN3mfWxRT2FdEmJ6uMB8Ipv7VAlBwWWGg86mFqZkVq0Hj57pGJXbbK6Zq6SDn5O351PVRZ6gfidpulbgMz8hYlFShSDSo3Mt9L4YMcS4ZwyQlezIhJ0Uk8wDMjXKXKpEQTn+ZA146yIb0//PBaOkKubgAmYgAmYwGsR0OfrsATz5XSeogxVLcFMPraI6mfX2SCSVAXqu/NcvkOB3W438YhdUHgqJfmE6+FwwNtCJUGi3USn6MzywVXdpW/QT3RT/aQoVydT9wLk5W7DwiIlupYTL21HZ+RLd8TOm4AJmIAJmIAJmMCdCViJLgLOyPwiK65sAiZgAiZgAiZgAj+SgJXolcOOSLje8b/SkKuZgAmYgAmYgAmYwE8lYCX6U0fe/TYBEzABEzABEzCBRxOwEn30CLh9EzABEzABEzABE/ipBKxEf+rIu98mYAImYAImYAIm8GgCVqKPHgG3bwImYAImYAImYAI/lYCV6E8deffbBEzABEzABEzABB5N4Bol+nJf0Ew/38rv3OpHdB87FjM/GDsMQ9M0p9Npobf4eu3ZbwUvbCWtfudupg5kNzXQYl3X3e6TCGdbhyfd95965bQJmIAJmIAJvCWBpUp0prB4LLvSdk1nN/g663ZJWOguBdxYAtbw+SfuZ8Amwm6iqXoulWT+RYmLlOjtuqnbQgQmAchFvZsoXOoLqyxUohOTahiGj48P3RiWV0RVVek8wehoDt1zwgRMwARMwATeicCPUKKlIO6EaJg5xllZo7vcBjvYMaxpmqC60i/kd99/3GVUN926v/q/XTfJB526QzezfaEbyxOlSZV2UOVmVqRO7z633FVbMAETMAETMIGHE5irRDVEV1UVFAO3W8UOqsgPKy4PT6dT0zSQXFVV6W1xjSCqFtGAmeZjt3e1MMGRDqRlUtGgnuida82HiNRoFrpPf9q2LUWzEOfTfWDHcYSHpSrobKpc1b20a9M53PZXzR6Px7qu+77fbDZVVcH+nbsZRnmhatRRIy7Y/Pz8DNv+konu2MvRQWHFNY6jVun7XptDeb3Ln/YlhOrT66U0Z3pYfdYETMAETMAEXo7AXCWqt0p1gcyqKF1iGexBSa7NNKhKEWs5NBnCh3orU+G2bUvlp/manlYG4zgGJaqeIE3l8fv37+PxyAglVWMqL+A2hY46ycBnUKLBDe0C0mTFU9NwWGw6EdwALjisAzGO4x26me1RNnO6UzxbGk19OoKTk7UwK/QeOuGrQchQHVxaKI2m/mpQOPAPh1nsbMUJEzABEzABE3gPArOUaFhcdU3F8kxlBigqILi+hpIUN+EVHJaHGApBsiugBwGhFkK/qBRRJpxlRe0+e8GzCCJSwrZti2icdp99RK3UCK1BjlC+M1+tMfPSRHBDRw2BWMJPPVyxm4wsEho7sqSbpdHUvmTnhspTxIlxEaLSMCh1Opxe3uBUtiPaUOCJWqUZqM05bQImYAImYAIvTeAmSpQ6BnfkEdcMizGFgt6CD/dAeWs4G3yayT2rNlA3rPSqUYKkCE5OSzR9vI9NqOzTNKJrvHccOgUCQeijjAriUGvmYXDjUiW6YjfhsIbS2YWru1kazZCf2k8FIqYl/uVDCxo3pbdh2jC/pFypwuu6/vz85LxCxTAitOaECZiACZiACbwNgVspUaz3X19f/ORQqkSxqAdlkCXbdd3VYvQiJaqtUCsHOajaJXU+qAco0X/++aeuaxU0+jBiagQQ0G5QJzgVYGahnc1cokRX7Cb9pGpnzpJucvhgjYdKO2s/KFEV3HQsdJ/5JSWabUhr4eItXHKkQEIVH5qACZiACZjAqxOYpUQ1ooMojsojPkinLLD0/vr1i4urLsZ6513TakHTlBHMnPOcKAqjXXWYRsJKr55oLZUmCI7Smp6iWQWiaRYIEjC4gWITMhSPq+52u/AQLV4gI3A2V0oEN4K6UsF9u26qbymr4BIKz+xmaTRViabzClKS8U5Mg/SxAQjHbCQb7aajoDy11+xU2oq6mlZxjgmYgAmYgAm8AYFZShRPyPHWeff9x85j6cVZSrT0lQ4s6owLakm1wA8r6g3x9EHJhUqUd0XhD0Oh6okqA34loK7rpmnUeZqiEe2pGiGxIAFV9bIMW4SHgUBWowSVTFMhoe7BOJwMsi8opxt1k2arqkpZLekmXy/TPupMDh9wIKUguwMuHXodI5WenLo6aqnq1cmmZulJGALmO2ECJmACJmACb0NgrhK9osNZvaUL9hU237VKKlMmegptlJIMTxFMWHjUqZfoZjZEvZxY9npjwuyN3Jho0adMwARMwARM4P4EbqVEQ2CJ32VM9dP9+/ycLab3pkt+piUZt3t+vKnzz9ZNfu6g5NjV+emPomQK4dLnH82S/843ARMwARMwgZkE1leiiMzxJjv9KEXyWOCHJ2byCR+9ejloz9lNSvnSLfu1OGefN0iNd99/ab5zTMAETMAETODNCKyvRN8MkLtjAiZgAiZgAiZgAiZwIwJWojcCa7MmYAImYAImYAImYAJnCFiJngHk0yZgAiZgAiZgAiZgAjciYCV6I7A2awImYAImYAImYAImcIaAlegZQD5tAiZgAiZgAiZgAiZwIwJWojcCG83q29n6wXOUwwfew1d7+NV3fjM/GpXjiwpLvf+X1G8M4StC+NS8fr99jif/z6JTJmACJmACJmACJjBJwEp0Es9tTuoH3qFQ9/v9drtVJaplzn7hUgt3XZfdhfJsV1SJ6lc/S+mzBl3ABEzABEzABEzABKYJzFKifd83TVPX9WazORwOm82GWifdsfB0OjVN8/n5if0bEVGDxtLCtMAPTKIk4oXI5BaI4TDtEo3glG7vxK0Xq6qiQWxGmm6kqR5WVcXgpearEew/fmmkULfP6bqu73vYpxIN/VWNWOo7vQqbdqKn/197Z3DbOAxE0VJydQnuIK5AFbgCt6G7KnAXLkB3pQrffdcC+cDHByl7ZSkIQuDlRJPUcPi0h7dD2TLt+nL3eJXiNy/TRIshX0sDAhCAAAQgAAEIbCCw1kT1S/V62/vX19fpdJqmKYXJLqXOruvGcTwcDsP33+Vyyclq6/BXbWuivSdre5akZztUEJucTbTWMkWYpul6vaqdC3n1fHNmZu5tOhMxud/v7vlvw+l5ZhE209ZQ/aYAX1vsvfj4ronKNXM7ZiLttvI6ARoQgAAEIAABCEBgG4G1Jqqi2uVyGYbBnlS870eCZRNy5U/9eYI8z7NHNV9WOs+zq25eRS7lCYv79KIatepJ417LkzNJHVRAXbi4zcU0XnfaKV1q9fxcep5n7X0cx67r/H+AF7tIma4fOc1Rr1g3nr0cK58TXVNbrSPTAwEIQAACEIAABBYJ7DLRPPjWSbdrn7fbzYZnE02P8WghkZmlxFfH/dM05VDRLoLYRKW8h8OheIuj5itnD6lTyptV2MVtFgm89bHwTqlnPidqZ1WVt9hdvVZup+/78/k8ff9p496mC891BIE6Ho/X6/V0Oj2riQ7D8O6jCItr0QkBCEAAAhCAAATmed5roimXAmptsmvaRFNiXCL1/Pp+qD46juP5fH48HvUE9xRB0kQ9Jy0qvwPkPHX6bG9zDdJlWofa35BkO07hptqOE8jysC951rjf713XpUqur4kej8dpmor5eTr/VibPMqQfAhCAAAQgAAEIiMAuE5U/WZgU0VJow5MX5uQ0Lc+vb4mGPj8//QBoPScXVSYqYdan+XZfGacmaAkpshMuVsnMi6HN31iS8zlaYaJ6IMGH+IUaPttgXVtV/OJyL1o0sgyc9pntlaGKyHyEAAQgAAEIQAACiwR2majVx3XE2+1ms7TYuUIp39Jkm6LnL+aXhczFCe70Y45d1/V9r/h5sG6xyyP7j4+Pvu99Hp3PROZZdmZefHlo5TeWMkJmkhmKjLXbPxFaFJ5rE3WQjGwyK/UxTVTZat1kklVtx6cBAQhAAAIQgAAEthFYZaLbQv/IVbbYH4n2OojVWdPSzF5fyCgEIAABCEAAAhCAwAYCf9pEf9kF8/he5+OUADf8k+ISCEAAAhCAAAQgsJLAHzVRH7X7qHrlfnZO4yR6J0AuhwAEIAABCEAAAusJ/FETXb8BZkIAAhCAAAQgAAEINEoAE230xpE2BCAAAQhAAAIQaJ4AJtr8LWQDEIAABCAAAQhAoFECmGijN460IQABCEAAAhCAQPMEMNHmbyEbgAAEIAABCEAAAo0SwEQbvXGkDQEIQAACEIAABJongIk2fwvZAAQgAAEIQAACEGiUACba6I0jbQhAAAIQgAAEINA8AUy0+VvIBiAAAQhAAAIQgECjBDDRRm8caUMAAhCAAAQgAIHmCfwDxU5KMlGnCdgAAAAASUVORK5CYII=)

--------------------------------------------------------------------------------
"""

! pip install geopy --q

import geopy
from geopandas.tools import geocode
import pandas as pd
import numpy as np
import folium

customers_df = pd.read_excel("/content/drive/MyDrive/Repzone/Omdena_Repzone_v1.xlsx", sheet_name='Customer')

customers_df.info()

customers_df[['Latitude','Longitude']]

def convert_coordinates(df):
    """
    Converts 'Longitude' and 'Latitude' columns to numeric, handling comma as decimal if the dtype is not float.
    """
    cols_to_check = ['Longitude', 'Latitude']
    for col in cols_to_check:
        if col in df.columns and df[col].dtype != float:
            # Check if there are any non-numeric values containing comma
            non_numeric_with_comma = df[pd.to_numeric(df[col], errors='coerce').isna()][col].astype(str).str.contains(',').any()
            if non_numeric_with_comma:
                df[col] = df[col].str.replace(',', '.', regex=False)
            df[col] = pd.to_numeric(df[col], errors='coerce')
    return df

customers_df = convert_coordinates(customers_df)

customers_df[['Latitude','Longitude']]

customers_with_nan = customers_df.loc[np.where(customers_df['Latitude'].isna())][['Country','City','District','AddressText']]

len(customers_with_nan)

l_cols_concat = ['District','City','Country']

# Composing the Full address by concatenating the columns mentioned in the above list l_cols_concat
customers_with_nan['Full_Address'] = customers_with_nan['AddressText'].str.cat(others=customers_with_nan[l_cols_concat], sep=',',na_rep='')

customers_with_nan.head(2)

customers_with_nan['Full_Address'].iloc[0]

"""## Geocoding the missing addresses using ARCGIS API"""

geopy.geocoders.SERVICE_TO_GEOCODER

from tqdm.notebook import tqdm

locations = []

for index, row in tqdm(customers_with_nan.iterrows()):
  try:
    location = geocode(row['Full_Address'], provider='arcgis', timeout=10)
    locations.append(location)
  except Exception as e:
    print(f"Error processing {row['Full_Address']}: {e}")
    continue

geocoded_df = pd.DataFrame()

# Extract Latitude, Longitude, and Address
geocoded_df['Longitude'] = [loc.geometry.x if loc is not None else np.nan for loc in locations]
geocoded_df['Latitude'] = [loc.geometry.y if loc is not None else np.nan for loc in locations]
geocoded_df['Formatted_Address'] = [loc.address if loc is not None else np.nan for loc in locations]

geocoded_df

def preprocess(df):
  # Remove leading "0 " if it exists in the address column
  df['Formatted_Address'] = df['Formatted_Address'].astype(str).str.lstrip('0 ')
  df['Longitude'] = df['Longitude'].astype(str).str.extract(r'(-?\d+\.\d+)').astype(float)
  df['Latitude'] = df['Latitude'].astype(str).str.extract(r'(-?\d+\.\d+)').astype(float)
  df['Longitude'] = pd.to_numeric(df['Longitude'], errors='coerce')
  df['Latitude'] = pd.to_numeric(df['Latitude'], errors='coerce')
  return df

geocoded_df = preprocess(geocoded_df)

customers_with_nan = customers_with_nan.reset_index()

geocoded_df['Address'] = customers_with_nan['Full_Address']

geocoded_df.isna().sum()

geocoded_df

geocoded_df.loc[geocoded_df['Latitude'].isna()]

def plot_folium_map(df, start_location=None, zoom_start=12):
    """
    Plots locations from a DataFrame on a Folium map.

    Parameters:
    - df (pd.DataFrame): DataFrame containing 'Latitude', 'Longitude', and 'Address' columns.
    - start_location (tuple, optional): (latitude, longitude) for initial map focus. Defaults to first row.
    - zoom_start (int): Initial zoom level for the map.

    Returns:
    - folium.Map object
    """

    df = df.dropna(subset=['Latitude','Longitude'])

    # Default starting location: first row if not provided
    if start_location is None:
        start_location = (df.iloc[0]['Latitude'], df.iloc[0]['Longitude'])

    # Create a Folium map centered at the starting location
    m = folium.Map(location=start_location, zoom_start=zoom_start)

    # Add markers to the map
    for _, row in df.iterrows():
        folium.Marker(
            location=[row['Latitude'], row['Longitude']],
            popup=row['Address'],  # Display address on click
            tooltip=row['Address'],  # Show address on hover
            icon=folium.Icon(color="blue", icon="info-sign")  # Customize marker color
        ).add_to(m)

    return m

# Example Usage:
df = geocoded_df
map_object = plot_folium_map(df)
map_object.save("map.html")  # Save map as HTML
map_object  # Display in Jupyter Notebook

geocoded_df.to_csv("/content/drive/MyDrive/Repzone/geocoded_arcgis.csv", index= False)

geocoded_df.head(1)

df_merged = pd.concat([customers_with_nan.drop(columns=['Full_Address']), geocoded_df[['Latitude','Longitude']]], axis=1)

df_merged.head(2)

customers_df['index'] = customers_df.index

col_list = list(df_merged.columns)

col_list.remove('index')
print(col_list)

# Merge on 'ID' and fill missing values using df2
final_df = customers_df.merge(df_merged, on='index', how='left', suffixes=('', '_fill'))

# Fill missing values from df2 into df1
for col in ['Latitude', 'Longitude']:
    final_df[col] = final_df[col].fillna(final_df[f"{col}_fill"])

# Drop extra columns
final_df = final_df.drop(columns=[col + "_fill" for col in col_list])

final_df.columns

final_df.shape

final_df.drop(columns=['index'],axis=1, inplace=True)

final_df.isna().sum()

"""## Dropping the one customer for which the address was not geocoded."""

final_df.dropna(subset=['Latitude','Longitude'], inplace=True)

final_df.shape

final_df.isna().sum()

"""## Regions by City
credits: Used code by Swati Thapa for getting the regions
"""

import requests

def get_region_from_city(city_name):
    # Nominatim API endpoint
    url = "https://nominatim.openstreetmap.org/search"
    params = {
        'q': f"{city_name}, Turkey",
        'format': 'json',
        'addressdetails': 1  # Include address details in the response
    }

    # Add a User-Agent header to identify your application
    headers = {
        'User-Agent': 'xxxxxxxx'  # Replace with your app name
    }

    try:
        # Make the request
        response = requests.get(url, params=params, headers=headers)

        # Check if the response is valid JSON
        if response.status_code == 200:
            data = response.json()

            # Check if data is not empty
            if data:
                # Extract the region from the address details
                address_details = data[0].get('address', {})
                region = address_details.get('region', 'Unknown')
                return region
            else:
                return "Unknown (No results found)"
        else:
            return f"Unknown (Request failed with status code: {response.status_code})"

    except requests.exceptions.JSONDecodeError as e:
        return f"Unknown (JSONDecodeError: {e})"

    except Exception as e:
        return f"Unknown (An error occurred: {e})"

cities=list(set(final_df.City.to_list()))
city_region={}

for city in cities:
    region = get_region_from_city(city)
    city_region[city] = region
    print(f"City: {city}, Region: {region}")

set(city_region.values())

"""There are 7 regions."""

regions_dict = {
    "Akdeniz Bölgesi": "Mediterranean",
    "Doğu Anadolu Bölgesi": "Eastern Anatolia",
    "Ege Bölgesi": "Aegean",
    "Güneydoğu Anadolu Bölgesi": "Southeastern Anatolia",
    "Karadeniz Bölgesi": "Black Sea",
    "Marmara Bölgesi": "Marmara",
    "İç Anadolu Bölgesi": "Central Anatolia"
}

city_region_eng={}
for i in city_region.keys():
  city_region_eng[i]=regions_dict[city_region[i]]

final_df['region'] = final_df['City'].map(city_region_eng)

final_df.shape

final_df.info()

"""## Adding a random Priority column"""

# Assign random priority (1 = High Priority, 10 = Low Priority)
final_df['Priority'] = np.random.randint(1, 11, size=len(final_df))  # Random values between 1 and 10

final_df['Priority'].value_counts()

final_df.info()

final_df.to_csv("/content/drive/MyDrive/Repzone/customers_with_region_and_priority.csv", index=False)

"""-------------------------End of notebook-------------------------------------

## Data cleaning: City and District columns
 Removing duplicates such as ("Aydin" vs. "Aydın", "Diyarbakir" vs. "Diyarbakır", etc.) and inconsistent capitalization issues (e.g., İZMIR vs. İzmir) in 'City' and 'District' columns.
"""

import pandas as pd
import unicodedata
import re

df = pd.read_csv("/content/drive/MyDrive/Repzone/customers_with_region_and_priority.csv")

"""**Comprehensive Character Normalization**

1. Uses Unicode normalization to strip accents,
2. Converts to ASCII representation,
3. Handles multiple variations of similar-looking characters.


**Regex-based Replacements**

1. Specifically targets variations like Şişli/Sisli,
2. Standardizes different representations of characters like 'S', 'Ş', 'I', 'İ',
3. Case-insensitive matching.


**Flexible Preprocessing**

1. Handles various input formats,
2. Supports uppercase, lowercase, or no case transformation,
3. Optional duplicate removal.
"""

def preprocess_city_district_names(df, columns, case='upper', remove_duplicates=False):
    """
    Preprocessing of city and district names with character normalization.

    Parameters:
    -----------
    df : pandas.DataFrame
        Input DataFrame containing city and district names
    columns : list or str
        Column name(s) to preprocess
    case : str, optional (default='upper')
        Desired case for city and district names ('upper', 'lower', or None)
    remove_duplicates : bool, optional (default=True)
        Whether to remove duplicate entries

    Returns:
    --------
    pandas.DataFrame
        DataFrame with preprocessed city names
    """
    # Ensure columns is a list
    if isinstance(columns, str):
        columns = [columns]

    # Create a copy of the DataFrame to avoid modifying the original
    df_processed = df.copy()

    def normalize_city_name(city):
        # Handle None or NaN values
        if pd.isna(city):
            return city

        # Convert to string
        city = str(city)

        # Specific Turkish character mapping
        char_map = {
            'İ': 'I', 'ı': 'i',
            'Ç': 'C', 'ç': 'c',
            'Ğ': 'G', 'ğ': 'g',
            'Ö': 'O', 'ö': 'o',
            'Ş': 'S', 'ş': 's',
            'Ü': 'U', 'ü': 'u'
        }

        # Replace special characters
        for k, v in char_map.items():
            city = city.replace(k, v)

        # Remove any remaining diacritical marks
        city = ''.join(char for char in unicodedata.normalize('NFKD', city)
                       if unicodedata.category(char) != 'Mn')

        # Apply case transformation
        if case == 'upper':
            city = city.upper()
        elif case == 'lower':
            city = city.lower()

        return city

    # Apply preprocessing to specified columns
    for col in columns:
        # Preprocess city names
        df_processed[col] = df_processed[col].apply(normalize_city_name)

        # Remove duplicates if specified
        if remove_duplicates:
            # Get the first occurrence of each unique city
            df_processed = df_processed.drop_duplicates(subset=col, keep='first')

    return df_processed

print("\nPreprocessed DataFrame:")
df_processed = preprocess_city_district_names(df, ['City','District'], case='upper')
print(df_processed)

# Print processed unique cities
print("\nUnique Processed Cities:")
print(df_processed['City'].unique())
print("Number of unique cities: ", len(df_processed['City'].unique()))

# Print processed unique districts
print("\nUnique Processed Cities:")
print(df_processed['District'].unique())
print("Number of unique districts: ", len(df_processed['District'].unique()))

"""**Number of unique cities:  65**

**Number of unique districts:  274**

"""

unqiue_cities = sorted(df_processed['City'].unique().tolist())
unqiue_cities

unique_districts = sorted(df_processed['District'].unique().tolist())
unique_districts

"""Ran the below code to fetch the regions on the cities just to be sure.


"""

import requests

def get_region_from_city(city_name):
    # Nominatim API endpoint
    url = "https://nominatim.openstreetmap.org/search"
    params = {
        'q': f"{city_name}, Turkey",
        'format': 'json',
        'addressdetails': 1  # Include address details in the response
    }

    # Add a User-Agent header to identify your application
    headers = {
        'User-Agent': 'xxxxxx'  # Replace with your app name
    }

    try:
        # Make the request
        response = requests.get(url, params=params, headers=headers)

        # Check if the response is valid JSON
        if response.status_code == 200:
            data = response.json()

            # Check if data is not empty
            if data:
                # Extract the region from the address details
                address_details = data[0].get('address', {})
                region = address_details.get('region', 'Unknown')
                return region
            else:
                return "Unknown (No results found)"
        else:
            return f"Unknown (Request failed with status code: {response.status_code})"

    except requests.exceptions.JSONDecodeError as e:
        return f"Unknown (JSONDecodeError: {e})"

    except Exception as e:
        return f"Unknown (An error occurred: {e})"

cities=list(set(df_processed.City.to_list()))
city_region={}

for city in cities:
    region = get_region_from_city(city)
    city_region[city] = region
    print(f"City: {city}, Region: {region}")

set(city_region.values())

regions_dict = {
    "Akdeniz Bölgesi": "Mediterranean",
    "Doğu Anadolu Bölgesi": "Eastern Anatolia",
    "Ege Bölgesi": "Aegean",
    "Güneydoğu Anadolu Bölgesi": "Southeastern Anatolia",
    "Karadeniz Bölgesi": "Black Sea",
    "Marmara Bölgesi": "Marmara",
    "İç Anadolu Bölgesi": "Central Anatolia"
}

city_region_eng={}
for i in city_region.keys():
  city_region_eng[i]=regions_dict[city_region[i]]

df_processed['Region'] = df_processed['City'].map(city_region_eng)

"""Checking if there is any difference. Since there is no difference, dropped the 'Region' column and retained the 'region' column."""

import numpy as np
df_processed.iloc[np.where(df_processed['Region'] != df_processed['region'])]

df_processed.drop(columns=['Region'], inplace=True)

df_processed['region'].value_counts()

df_processed.columns

df_processed.info()

df_processed.isnull().sum()

df_processed.index

df_processed.to_csv("/content/drive/MyDrive/Repzone/customers_with_region_and_priority_V2.csv", index=False)